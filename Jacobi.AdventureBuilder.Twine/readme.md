# Twine Import

This utitlity transforms the adventure world definition from and to Twine.

Twine (download desktop app): https://twinery.org/

> Twine needs to have a plugin installed that allows the Twine definition to be represented as JSON.

The plugin: https://jtschoonhoven.github.io/twine-to-json/dist/harlowe-3.js

How to install the plugin: https://github.com/jtschoonhoven/twine-to-json

It is this JSON output generated by the Twine plugin that we use as an import.

## Twine Authoring

> Make sure you set the Story Format to `Harlow 3 to JSON x.x.x`. Navigate to the Story->Details to change it. If you already have some passages created, you need to change each one separately.

### Passage

For each Passage enter a description (text) to set the mood of the place.

At the bottom, add the navigation options that are accessable from this Passage.

#### Passage Tags

Passage Tags...

### Passage Navigation

There are a couple of ways you can define a link from the current Passage to another Passage.

| Link Syntax | Description |
| -- | -- |
| `[[Passage Target]]` | This will navigate to a Passage called `Passage Target` and that will also be displayed in the game. No extra link description is available here. |
| `[[Go to Passage Target->Passage Target]]` | This will navigate to a Passage called `Passage Target` but "Go to Passage Target" will be displayed in the game. No extra link description is available here. |
| `|Passage Target>[This is the desciption of Passage Target]` | This will add a description to a navigation link (one of the above) called `Passage Target`. Place this close to the link it is connected to (`Passage Target`). |

> Make sure you do not define any links to Non-Player Characters (NPC) - that are also Passages in Twine.

### Non-Player Characters (NPC)

Create a Passage in Twine and start its name with `NPC:`. Now put a description in the passage that will describe the NPC. If you put no links in this passage, the NPC can popup anywhere. If you put links on this NPC to other passages, the NPC will only appear there.

Any text or description you give the links to other passages will be ignored for the moment. So just a simple `[[Passage]]` will do.

> We have not defined a way to provide any (time) constraints to the NPC.

#### Non-Player Character Tags

Non-Player Character Tags...

### Generating JSON

With the Story open, navigate to the `Build` menu and select `Test` or `Play`. The JSON is now opened in the default browser and can be copied to a file. Make sure you copy everything in order not to save a corrupt file.

---

## Twine Import

The `Jacobi.AdventureBuilder.Twine` application takes a Twine JSON file and converts it to the format the game uses and stores it in the AdventureBuilder store.

### Commandline

To import a Twine JSON file use:

`Jacobi.AdventureBuilder.Twine --file "file path\with spaces.json"`

> Use double quotes around the file path if it contains spaces.

| Option | Description |
| -- | -- |
| -- file, -f | Loads the json file to be imported into the Adventure Builder.

### Configuration

It uses the REST API to perform this action and that requires a bit of configuration. Open the `appsettings.json` file to point to the base url of the REST API Service.

```json
{
  "ApiServiceUrl":  "https://localhost:7395"
}
```

---

> At one point it may become necessary to write our own Story Format (like Harlowe) in Twine (together with a JSON exporter plugin).
